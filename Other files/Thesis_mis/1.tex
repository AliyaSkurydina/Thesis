\chapter{Постановки нелинейных обратных задач гравиметрии и магнитометрии о восстановлении поверхностей раздела}

В данной главе рассматриваются постановки обратных структурных задач гравиметрии и магнитометрии о восстановлении поверхностей раздела слоев в однородно-слоистой среде по гравитационным либо магнитным данным. Показано, что рассматриваемые в диссертационной работе прикладные задачи сводятся к решению нелинейных уравнений большой размерности. 

%\section{Постановки задач}

\newpage
\section{Обратные задачи гравиметрии и магнитометрии о восстановлении одной поверхности раздела}

%В \S 1 приводятся постановки задач гравиметрии и магнитометрии, рассмотренных в работах Б.~В.~Нумерова \footnote{Нумеров, Б. В. Интерпретация гравитационных наблюдений в случае одной контактной поверхности // ДАН СССР 21 (1930): 569-574.}, Н.~Р.~Малкина \footnote{Малкин, Н. Р. О решении обратной магнитометрической задачи для случая одной контактной поверхности (случай пластообразно залегающих масс) // ДАН СССР. Сер. А 9 (1931): 232-235.}, В.~Н.~Страхова, П.~С.~Мартышко, И.~Л.~Пруткина.

%П. С. Мартышко \footnote{Мартышко, П. С.,  Ладовский, И. В., Цидаев, А. Г. Построение региональных геофизических моделей на основе комплексной интерпретации гравитационных и сейсмических данных // Физика Земли 11 (2010): 23-35.}
%footnote{В. Н. Страхов, С. Н. Иванов, Метод аналитического продолжения трехмерных потенциальнх полей // Теория и практика геологической интерпретации гравитационных и магнитных аномалий. Алма-Ата:1984, т. 2, с. 68-70}
%\footnote{Пруткин, И. Л. О приближенном решении трехмерных обратных задач гравиметрии и магнитометрии методом локальных поправок // Изв. АН СССР. Физика Земли 1 (1983): 53-58.}, 

Рассмотрим постановку обратной задачи гравиметрии для одной поверхности раздела с горизонтальной асимптотической плоскостью.

Введем трехмерную декартову систему координат, в которой плоскость $x0y$ совпадает с земной поверхностью, а ось $z$ направлена вертикально вниз. Предполагается, что нижнее полупространство состоит из двух слоев постоянной плотности $\sigma_1$ и $\sigma_2$, разделенных искомой поверхностью (рис.~\ref{fig1}). Пусть поверхность раздела задается уравнением $z=\zeta(x,y)$. Поверхность имеет асимптотическую плоскость, залегающую на глубине $z=h$, другими словами, $\lim \limits_{| x  | + | y | \rightarrow \infty}| \zeta(x,y)-h | =0$. 

\begin{figure}[h]
\center{\includegraphics[height=.33\textheight]{w_grav.png}}
\caption{Модель двуслойной среды в задаче гравиметрии}\label{fig1}
\end{figure}

Если исходить из того, что гравитационная аномалия создана отклонением искомой поверхности от асимптотической плоскости, то аномальное гравитационное поле (вертикальная компонента ускорения свободного падения, первая производная ньютоновского потенциала), порождаемое таким полупространством и измеренное на земной поверхности $z=0$, с точностью до постоянного слагаемого будет равным полю тела, ограниченного поверхностью $\zeta(x,y)$ и плоскостью $h$ и имеющего постоянную плотность $\Delta\sigma$. Гравитационный потенциал такого тела $D$ равен~\cite{grav_sl} 
\begin{equation}\nonumber
V(\boldsymbol{r}_0)= f \Delta \sigma \int\limits_D \frac {1}{ | \boldsymbol{r}-\boldsymbol{r}_0 |} dr,
\end{equation}
где $\boldsymbol{r}_0$ --- радиус-вектор точки наблюдения, $\boldsymbol{r}$ --- радиус-векторы точек тела~$D$.

Тогда поле, порождаемое поверхностью, с точностью до постоянного слагаемого найдется по формуле~\cite{prutkin1983, martyshko2010}:

\begin{equation}\label{eq1grav}
\begin{aligned}
f \Delta \sigma \int\limits_{-\infty}^\infty
\int\limits_{-\infty}^\infty \Bigg [ \frac{1}{\sqrt{(x-x')^2+(y-y')^2+\zeta^2(x,y)}} - \\[16pt]
-\frac{1}{\sqrt{(x-x')^2+(y-y')^2+h^2}} \Bigg ] dxdy = \Delta g(x',y',0),
\end{aligned}
\end{equation}
где  $f$ --- гравитационная постоянная, $\Delta \sigma = \sigma_2-\sigma_1$ --- скачок плотности на границе.

%Это уравнение связывает наблюдаемое изменение $\Delta g(x',y',0)$ и форму поверхности $\zeta(x,y)$.

Обратная задача состоит в определении формы поверхности $\zeta(x,y)$ по данным об изменении силы тяжести на поверхности Земли $\Delta g(x',y',0)$. Исходными данными считаются плотности слоев $\sigma_1, \sigma_2$ и глубина залегания плоскости $h$.

Для предварительной обработки данных с целью выделения аномального поля, порождаемого искомой поверхностью, из наблюденного гравитационного поля используется технология разделения источников по глубине, предложенная в работе~\cite{mart_prut_2003}.

При известных значениях поля $\Delta g(x',y',0)$, скачка плотности $\Delta \sigma$ и глубины $h$ залегания асимптотической плоскости формулу~\eqref{eq1grav} можно рассматривать как двумерное нелинейное интегральное уравнение первого рода от функции $z=\zeta(x,y)$. Можно записать его в операторном виде

\begin{equation}\label{eq1gravop}
A(z) = \Delta g(x',y',0).
\end{equation}

Поскольку поверхность имеет асимптоту, значения поля вне некоторой прямоугольной области $a \leqslant x \leqslant b, c \leqslant y \leqslant d$ будут близки к нулю, поэтому можно перейти от бесконечных пределов интегрирования к конечной области. После дискретизации уравнения~\eqref{eq1grav}--\eqref{eq1gravop} на сетке $n=M\times N$ (рис.~\ref{fig1discret}) с шагами $\Delta x \lbcomma \Delta y$, где задана правая часть $\Delta g(x,y,0)$ и аппроксимации интегрального оператора $A(z)$ по квадратурным формулам прямоугольников, имеем вектор правой части $F=(F_1,F_2,...,F_n)$ размерности $n$, вектор решения $z$ размерности $n$ и систему $n$ нелинейных уравнений

\begin{equation}\label{eq1grav_dis}
\begin{aligned}
f \Delta \sigma \Delta x \Delta y \sum \limits_{j=1..n} \Bigg [ \frac{1}{\sqrt{(x_i-x_j)^2+(y_i-y_j)^2+z^2_j}} - \\[16pt]
-\frac{1}{\sqrt{(x_i-x_j)^2+(y_i-y_j)^2+h^2}} \Bigg ] = F_i, \quad i=1..n.
\end{aligned}
\end{equation}
 
\begin{figure}[h]
\center{\includegraphics[height=.33\textheight]{indices1.png}}
\caption{Распределение индексов по сетке}\label{fig1discret}
\end{figure}

В операторном виде система~\eqref{eq1grav_dis} записывается в виде

\begin{equation}\label{eq1grav_disop}
A[z]=F.
\end{equation}

Постановка обратной задачи магнитометрии для одной поверхности раздела для случая вертикальной намагниченности выглядит аналогично. Предполагается, что нижнее полупространство состоит из двух слоев постоянной вертикально направленной намагниченности $J_1$ и $J_2$, разделенных искомой поверхностью (рис.~\ref{fig2}). Поверхность раздела с асимптотической плоскостью $h$ задается уравнением $z=\zeta(x,y)$.

\begin{figure}[h]
\center{\includegraphics[height=.33\textheight]{w_magn.png}}
\caption{Модель двуслойной среды в задаче магнитометрии}\label{fig2}
\end{figure}

Для нахождения аномального магнитного эффекта однородного тела используется теорема Пуассона~\cite{yanovskii}: магнитный потенциал однородно намагниченного тела вычисляется по формуле $U=- \frac{1}{4\pi} \langle \boldsymbol{J},\nabla V \rangle$, где $V$ --- гравитационный потенциал тела такой же формы и размеров, имеющего постоянную плотность, такую что $f \sigma = 1$. Вертикальная компонента напряженности магнитного поля, порождаемого поверхностью, будет находиться по формуле

\begin{equation}\label{eq1magn}
\begin{aligned}
&\frac{\Delta J}{4\pi} \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \Bigg [ \frac{\zeta(x,y)}{\big((x-x')^2+(y-y')^2+\zeta^2(x,y)\big)^{3/2}} -\\[16pt]
& - \frac{h}{\big((x-x')^2+(y-y')^2+h^2\big)^{3/2}} \Bigg ] dx dy =\Delta Z(x',y',0),
\end{aligned}
\end{equation}
где $\Delta J=1-J_2$ --- скачок намагниченности на границе раздела сред.

При известном значении поля $\Delta Z(x',y',0)$, скачка намагниченности $\Delta J$ и глубины $h$ формула~\eqref{eq1magn} является двумерным нелинейным интегральным уравнением первого рода от функции $z=\zeta(x,y)$. Можно записать его в операторном виде

\begin{equation}\label{eq1magnop}
B(z) = \Delta Z(x',y',0).
\end{equation}


%Уравнения~\eqref{eq1grav} и~\eqref{eq1magn} являются нелинейными двумерными интегральными уравнениями первого рода относительно функции $\zeta(x,y)$ описывающей искомую контактную поверхность.
%Функция $z(x,y)$ описывающая искомую контактную поверхность, удовлетворяет нелинейному двумерному интегральному уравнению первого рода~\eqref{eq1grav} либо~\eqref{eq1magn}. 
%, матрицу производной оператора $A'(z^k)^T$ размерности $n \times n$ 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

После дискретизации уравнения~\eqref{eq1magn}--\eqref{eq1magnop} на сетке $n=M\times N$, где задана правая часть $\Delta Z(x,y,0)$, и аппроксимации интегрального оператора $B(z)$ по квадратурным формулам, имеем вектор правой части $F(x,y)$ размерности $n$, вектор решения $z$ размерности $n$ и систему $n$ нелинейных уравнений вида

\begin{equation}\label{eq1magn_dis}
\begin{aligned}
&\frac{\Delta J}{4\pi} \Delta x \Delta y \sum \limits_{j=1..n} \Bigg [ \frac{-h}{\big((x_i-x_j)^2+(y_i-y_j)^2+h^2\big)^{3/2}} -\\[16pt]
& - \frac{-z_j }{\big((x_i-x_j)^2+(y_i-y_j)^2+z_j\big)^{3/2}} \Bigg ] =F_i, \quad i=1..n. \\[16pt]
\end{aligned}
\end{equation}

В операторном виде

\begin{equation}\label{eq1magn_disop}
B[z]=F.
\end{equation}

%\begin{equation}\label{eq2}
%A(z)=F.
%\end{equation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Для решения этой системы ранее применялись метод локальных поправок \footnote{Мартышко П.С., Цидаев А.Г. О решении трехмерной обратной задачи гравиметрии методом локальных поправок. Геофизические исследования Урала и сопредельных регионов. Материалы Международной конференции, посвященной 50 летию Института геофизики УрО РАН. Екатеринбург: ИГФ УрО РАН. 2008. С. 167–170.}, 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Обратные задачи гравиметрии и магнитометрии являются существенно некорректными задачами, решение которых обладает сильной чувствительностью к погрешностям правых частей, полученных в результате измерений и предварительной обработки геофизических данных. Поэтому при решении задач используются методы итеративной регуляризации~\cite{bakushinskii, vasin_eremin}.

\newpage
\section{Получение уравнения структурной обратной задачи магнитометрии для случая произвольно направленной суммарной намагниченности}

Приведем детальный вывод уравнения обратной задачи магнитометрии для случая произвольно направленной суммарной намагниченности.

Введём трехмерную декартову систему координат, в которой координатная плоскость $x0y$ совпадает с земной поверхностью, а ось $z$ направлена вертикально вниз. 

Построим выражение для прямой задачи нахождения магнитного поля от поверхности $\zeta(x,y)$ в случае, когда слои имеют произвольно направленные намагниченности $\boldsymbol{J}_1$ и $\boldsymbol{J}_2$. %(рис.~\ref{fig3}). 

%\begin{figure}[h]
%\center{\includegraphics[height=.33\textheight]{magn_0a.png}}

%\caption{Модель двуслойной среды для случая произвольно направленной суммарной намагниченности}\label{fig3}
%\end{figure}

%\newpage
Для этого рассмотрим однородное тело в виде слоя, ограниченного криволинейными поверхностями $z=z_1(x,y)$, $z=z_2(x,y)$ и имеющего намагниченность $\boldsymbol{J}=(J_x, J_y, J_z)$. %(рис.~\ref{fig4}).

%\begin{figure}[h]
%\center{\includegraphics[height=.33\textheight]{magn_1.png}}

%\caption{Субгоризонтальный слой с постоянной намагниченностью}\label{fig4}
%\end{figure}

Согласно соотношению Пуассона, магнитный потенциал $U$ однородно намагниченного тела можно найти по формуле 

\begin{equation} \nonumber
U=- \frac{1}{4\pi} \langle \boldsymbol{J},\nabla V \rangle,
\end{equation}
где $V$ --- гравитационный потенциал тела такой же формы и размеров, имеющего постоянную плотность $\sigma$, равную обратной величине гравитационной постоянной~$f$. 

Гравитационный потенциал однородного тела $D$ произвольной формы находится по формуле
\begin{equation}\nonumber
V(\boldsymbol{r}_0)= f  \sigma \int\limits_D \frac {1}{ | \boldsymbol{r}-\boldsymbol{r}_0 |} dr,
\end{equation}
где $\boldsymbol{r}_0$ -- радиус-вектор точки наблюдения, а $\boldsymbol{r}$ -- радиус-векторы точек тела~$D$.

Подставив в пределы интегрирования границы рассматриваемого тела, получим
\begin{equation}\nonumber
V(x_0,y_0,z_0) = f  \sigma \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \Bigg ( \int \limits_{z_1(x,y)}^{z_2(x,y)}   \frac {dz}{\big((x-x_0)^2+(y-y_0)^2+(z-z_0)^2 \big)^{1/2}}\Bigg ) dx dy 
\end{equation}

Найдем компоненты $\nabla V$:

\begin{equation}\nonumber
\frac{\partial V(x_0,y_0,z_0)}{\partial {x_0}} = \\
\end{equation}
\vspace*{16pt}
\begin{equation}\nonumber
 = f \sigma \frac{\partial}{\partial {x_0}} \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \Bigg ( \int \limits_{z_1(x,y)}^{z_2(x,y)}  \frac {dz}{\big((x-x_0)^2+(y-y_0)^2+(z-z_0)^2 \big)^{1/2}} \Bigg ) dx dy=\\
 \end{equation}
 \vspace*{16pt}
\begin{equation}\nonumber
%\setlength{\jot}{16pt}
\begin{aligned}
& = f  \sigma \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \frac {x-x_0}{(x-x_0)^2+(y-y_0)^2} \times \\[16pt]
&\times \left. \Bigg [ \frac{z-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z-z_0)^2\big)^{1/2}}\Bigg ] \right \vert^{z_2(x,y)}_{z_1(x,y)} dx dy =\\
\end{aligned}
\end{equation}
\vspace*{16pt}
\begin{equation}\nonumber
%\setlength{\jot}{16pt}
\begin{aligned}
&=- f  \sigma \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \frac {x-x_0}{(x-x_0)^2+(y-y_0)^2} \times\\[16pt]
&\times \Bigg [ \frac{z_1(x,y)-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z_1(x,y)-z_0)^2\big)^{1/2}} - \\[16pt]
&- \frac{z_2(x,y)-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z_2(x,y)-z_0)^2\big)^{1/2}}\Bigg ] dx dy;\\
\end{aligned}
\end{equation}

\vspace {40pt}

\begin{equation}\nonumber
\frac{\partial V(x_0,y_0,z_0)}{\partial {y_0}} = \\
\end{equation}
\vspace*{16pt}
\begin{equation}\nonumber
 = f \sigma \frac{\partial}{\partial {x_0}} \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \Bigg ( \int \limits_{z_1(x,y)}^{z_2(x,y)} \frac {dz}{\big((x-x_0)^2+(y-y_0)^2+(z-z_0)^2 \big)^{1/2}} \Bigg ) dx dy=\\
 \end{equation}
 \vspace*{16pt}
\begin{equation}\nonumber
%\setlength{\jot}{16pt}
\begin{aligned}
& = f  \sigma \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \frac {y-y_0}{(x-x_0)^2+(y-y_0)^2} \times \\[16pt]
&\times \left. \Bigg [ \frac{z-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z-z_0)^2\big)^{1/2}}\Bigg ] \right \vert^{z_2(x,y)}_{z_1(x,y)} dx dy =\\
\end{aligned}
\end{equation}
\vspace*{16pt}
\begin{equation}\nonumber
%\setlength{\jot}{16pt}
\begin{aligned}
&=- f  \sigma \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \frac {y-y_0}{(x-x_0)^2+(y-y_0)^2} \times\\[16pt]
&\times \Bigg [ \frac{z_1(x,y)-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z_1(x,y)-z_0)^2\big)^{1/2}} - \\[16pt]
&- \frac{z_2(x,y)-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z_2(x,y)-z_0)^2\big)^{1/2}}\Bigg ] dx dy;\\
\end{aligned}
\end{equation}

\vspace {40pt} 

\begin{equation}\nonumber
\frac{\partial V(x_0,y_0,z_0)}{\partial {z_0}} =\\
\end{equation}
\begin{equation}\nonumber
\begin{aligned}
&=f  \sigma \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \left. \Bigg [ \frac{-1}{\big((x-x_0)^2+(y-y_0)^2+(z-z_0)^2\big)^{1/2}}\Bigg ] \right \vert^{z_2(x,y)}_{z_1(x,y)} dx dy = \\[16pt]
&=f  \sigma \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \Bigg [ \frac{1}{\big((x-x_0)^2+(y-y_0)^2+(z_1(x,y)-z_0)^2\big)^{1/2}} - \\[16pt]
&- \frac{1}{\big((x-x_0)^2+(y-y_0)^2+(z_2(x,y)-z_0)^2\big)^{1/2}}\Bigg ] dx dy.
\end{aligned}
\end{equation}

Имея выражения для компонентов $\nabla V$, получим вертикальную компоненту напряженности магнитного поля $\boldsymbol{H}=\nabla U$, подставив их в выражение:
\begin{equation}\nonumber
\Delta Z(x_0,y_0,z_0)  = \frac{\partial U(x_0,y_0,z_0)}{\partial z_0} = \\
\end{equation}
\vspace*{16pt}
\begin{equation}\nonumber
=- \frac{1}{4\pi} \frac{\partial}{\partial{z_0}} { \Bigg ( J_x \frac{\partial V(x_0,y_0,z_0)}{\partial {x_0}} + J_y \frac{\partial V(x_0,y_0,z_0)}{\partial {y_0}} + J_z \frac{\partial V(x_0,y_0,z_0)}{\partial {z_0}} \Bigg )}   = \\
\end{equation}
\vspace*{16pt}
\begin{equation}\nonumber
\begin{aligned}
&= - \frac{1}{4\pi} \frac{\partial}{\partial{z_0}} \Bigg \{ - J_x  \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \frac {x-x_0}{(x-x_0)^2+(y-y_0)^2} \times\\[16pt]
&\times \Bigg [ \frac{z_1(x,y)-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z_1(x,y)-z_0)^2\big)^{1/2}} - \\[16pt]
&- \frac{z_2(x,y)-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z_2(x,y)-z_0)^2\big)^{1/2}}\Bigg ] dx dy -\\[16pt]
&- J_y \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \frac {y-y_0}{(x-x_0)^2+(y-y_0)^2} \times\\[16pt]
&\times \Bigg [ \frac{z_1(x,y)-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z_1(x,y)-z_0)^2\big)^{1/2}} - \\[16pt]
&- \frac{z_2(x,y)-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z_2(x,y)-z_0)^2\big)^{1/2}}\Bigg ] dx dy +\\[16pt]
&+ J_z \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \Bigg [ \frac{-1}{\big((x-x_0)^2+(y-y_0)^2+(z_1(x,y)-z_0)^2\big)^{1/2}} - \\[16pt]
&- \frac{-1}{\big((x-x_0)^2+(y-y_0)^2+(z_2(x,y)-z_0)^2\big)^{1/2}}\Bigg ] dx dy \Bigg \} =
\end{aligned}
\end{equation}

\begin{equation}\nonumber
\begin{aligned}
&=  \frac{1}{4\pi} \Bigg \{ J_x  \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \frac {x-x_0}{(x-x_0)^2+(y-y_0)^2} \times\\[16pt]
&\times \Bigg [ \frac{(x-x_0)^2+(y-y_0)^2}{\big((x-x_0)^2+(y-y_0)^2+(z_1(x,y)-z_0)^2\big)^{3/2}} - \\[16pt]
&- \frac{(x-x_0)^2+(y-y_0)^2}{\big((x-x_0)^2+(y-y_0)^2+(z_2(x,y)-z_0)^2\big)^{3/2}}\Bigg ] dx dy +\\[16pt]
& +J_y \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \frac {y-y_0}{(x-x_0)^2+(y-y_0)^2} \times\\[16pt]
&\times \Bigg [ \frac{(x-x_0)^2+(y-y_0)^2}{\big((x-x_0)^2+(y-y_0)^2+(z_1(x,y)-z_0)^2\big)^{3/2}} - \\[16pt]
&- \frac{(x-x_0)^2+(y-y_0)^2}{\big((x-x_0)^2+(y-y_0)^2+(z_2(x,y)-z_0)^2\big)^{3/2}}\Bigg ] dx dy -\\[16pt]
&- J_z \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \Bigg [ \frac{z_1(x,y)-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z_1(x,y)-z_0)^2\big)^{3/2}} - \\[16pt]
&- \frac{z_2(x,y)-z_0}{\big((x-x_0)^2+(y-y_0)^2+(z_2(x,y)-z_0)^2\big)^{3/2}}\Bigg ] dx dy \Bigg \} =
\end{aligned}
\end{equation}

\vspace*{32pt}
\begin{equation}\nonumber
\begin{aligned}
& = \frac{1}{4\pi} \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \Bigg [ \frac{J_x(x-x_0)+J_y(y-y_0)-J_z(z_1(x,y)-z_0)}{\big((x-x_0)^2+(y-y_0)^2+(z_1(x,y)-z_0)^2\big)^{3/2}} -\\[16pt]
& - \frac{J_x(x-x_0)+J_y(y-y_0)-J_z(z_2(x,y)-z_0)}{\big((x-x_0)^2+(y-y_0)^2+(z_2(x,y)-z_0)^2\big)^{3/2}} \Bigg ] dx dy.
\end{aligned}
\end{equation}

\vspace*{32pt}

Чтобы перейти к выражению для магнитного поля криволинейной поверхности, применим прием, описанный в работе~\cite{martyshko2010}: исключим из полупространства слои, ограниченные горизонтальными плоскостями, поскольку такие слои не дают вклада в магнитное поле. Задача сведется к нахождению поля от тела, ограниченного поверхностью $z_1(x,y)=h$ и ее асимптотической плоскостью $z_2(x,y)=\zeta(x,y)$, имеющего намагниченность $\Delta \boldsymbol{J}=\boldsymbol{J}_1-\boldsymbol{J}_2$ (см. рис.~\ref{fig5}).

\begin{figure}[h]
\center{\includegraphics[height=.33\textheight]{magn_layer.png}}

\caption{Субгоризонтальный слой, эквивалентный поверхности раздела сред}\label{fig5}
\end{figure}

Для $\Delta Z(x \lbcomma y \lbcomma z)$, измеренной на земной поверхности $z_0=0$, получаем формулу:
\begin{equation}\label{eq1magnarb}
\begin{aligned}
\Delta Z(x',y',0) & = \frac{1}{4\pi} \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \Bigg [ \frac{\Delta J_x(x-x')+ \Delta J_y(y-y')-\Delta J_z h}{\big((x'-x)^2+(y'-y)^2+h^2\big)^{3/2}} -\\[16pt]
& - \frac{\Delta J_x(x-x')+\Delta J_y(y-y')-\Delta J_z \zeta(x,y) }{\big((x'-x)^2+(y'-y)^2+\zeta^2(x,y)\big)^{3/2}} \Bigg ] dx dy,
\end{aligned}
\end{equation}
где $\Delta \boldsymbol{J}=(\Delta J_x, \Delta J_y, \Delta J_z)$ --- скачок намагниченности. 

\begin{remark}
 В случае вертикально направленного скачка намагниченности уравнение совпадет с~\eqref{eq1magn}.
 
В случае горизонтально направленного скачка намагниченности уравнение приобретет следующий вид:
\begin{equation}\nonumber
\begin{aligned}
\Delta Z(x',y',0) & = \frac{1}{4\pi} \int \limits_{-\infty}^{\infty} \int \limits_{-\infty}^{\infty} \Big (\Delta J_x(x-x')+ \Delta J_y(y-y')\Big ) \times\\[16pt]
& \Bigg [ \frac{1}{\big((x'-x)^2+(y'-y)^2+h^2\big)^{3/2}} -\\[16pt]
& - \frac{1}{\big((x'-x)^2+(y'-y)^2+\zeta^2(x,y)\big)^{3/2}} \Bigg ] dx dy.
\end{aligned}
\end{equation}
\end{remark}

\begin{remark}
Аналогичное уравнение можно получить для модуля напряженности магнитного поля $\Delta T$. 
\end{remark}

При известных значениях $\Delta J_x, \Delta J_y, \Delta J_z, \Delta Z(x',y',0)$, $h$ выражение~\eqref{eq1magnarb} можно рассматривать как интегральное уравнение первого рода от функции $z=\zeta(x,y)$. 

%\begin{equation}\label{eq2magn4}
%A(z) = \Delta Z(x,y).
%\end{equation}

После дискретизации уравнения~\eqref{eq1magndisarb} на сетке $n=M \times N$, где задана правая часть $\Delta Z(x',y',0)$ и аппроксимации интегрального оператора $A(z)$ по квадратурным формулам имеем систему нелинейных уравнений вида~\eqref{eq1magn_disop}:

\begin{equation}\label{eq1magndisarb}
\begin{aligned}
\frac{1}{4\pi} \Delta x \Delta y \sum \limits_{j=1..n} \Bigg [& \frac{\Delta J_x(x_j-x_i)+ \Delta J_y(y_j-y_i)-\Delta J_z h}{\big((x_j-x_i)^2+(y_j-y_i)^2+h^2\big)^{3/2}} 
\end{aligned}
\end{equation}
\begin{equation} \nonumber
\begin{aligned}
& - \frac{\Delta J_x(x_j-x_i)+ \Delta J_y(y_j-y_i)-\Delta J_z z_j }{\big((x_j-x_i)^2+(y_j-y_i)^2+z_j\big)^{3/2}} \Bigg ] = F_i, \\[16pt]
& i=1..n. \\[16pt]
\end{aligned}
\end{equation}

%\begin{equation}\label{eq3}
%A_j(z) = F_j, \quad j=1,...,n.
%\end{equation}

Для решения этой задачи невозможно применить алгоритмы на основе метода локальных поправок, поэтому необходимо использовать алгоритмы на основе методов нелинейной минимизации.

Автор рекомендует использовать алгоритмы на основе нелинейного метода сопряженных градиентов, разработанные во второй главе данной диссертационной работы.

%во второй главе будет построен параллельный алгоритм на основе нелинейного метода сопряженных градиентов.

%Для решения этой задачи невозможно применить алгоритмы на основе метода локальных поправок, поэтому автор предлагает использовать параллельный алгоритм на базе линеаризованного метода сопряженных градиентов~\eqref{eq9}.


\newpage
\section{Обобщенные постановки обратных задач гравиметрии и магнитометрии для случая нескольких поверхностей}

%\textbf{Раздел 1.2} посвящен обобщению постановок задач на случай нескольких контактных поверхностей. 

Рассматривается трехмерная структурная обратная задача гравиметрии о нахождении поверхностей раздела сред по известным скачкам плотности и гравитационному полю, измеренному на некоторой площади земной поверхности.  

Предполагается, что нижнее полупространство состоит из нескольких слоев постоянной плотности, разделенных искомыми поверхностями $S_l (l=1\lbcomma ...\lbcomma L)$, где $L$ --- априорно известное число границ раздела (рис.~\ref{fig9}). Гравитационный  эффект от такого полупространства равен сумме гравитационных эффектов от всех поверхностей раздела~\cite{martyshko2010}.

\begin{figure}[h]
\center{\includegraphics[height=.5\textheight]{whitegrav.png}}
\caption{Модель многослойной среды в задаче гравиметрии}\label{fig9}
\end{figure}

Пусть поверхности раздела задаются уравнениями $\zeta_l=\zeta_l(x,y)$, скачки плотности на них равны $\Delta\sigma_l$, поверхности имеют горизонтальные асимптотические плоскости $\zeta_l=h_l$, т.е. $\lim \limits_{| x  | + | y | \rightarrow \infty}| \zeta(x,y)-h | =0$. Поле от суперпозиции границ с точностью до постоянного слагаемого равно

\begin{equation}\label{eq1_sumgrav}
\begin{aligned}
A(z)\equiv f \sum \limits_{l=1}^{L} \Delta \sigma_l \int\limits_{-\infty}^\infty
\int\limits_{-\infty}^\infty \Bigg\{ \frac{1}{\sqrt{(x-x')^2+(y-y')^2+\zeta^2_l(x,y)}} - \\
-\frac{1}{\sqrt{(x-x')^2+(y-y')^2+h^2_l}} \Bigg\} dxdy = \Delta g(x',y',0),
\end{aligned}
\end{equation}
где  $f$ --- гравитационная постоянная,  $L$ --- число границ раздела, $\Delta g(x,y,0)=\sum\limits^L_{l=0}\Delta g_l$ ---  суммарное аномальное гравитационное поле, измеренное на земной поверхности.

Уравнение~\eqref{eq1_sumgrav} при заданных значениях $L$, $f$, $\Delta\sigma_l$, $h_l$ является нелинейным двумерным интегральным уравненем первого рода относительно искомых функций $\zeta_l$. В операторном виде его можно записать как 

\begin{equation}\label{eq1gravop_sum}
A(\zeta_1,\zeta_2,...,\zeta_L) = \Delta g(x',y',0).
\end{equation}

%Задача~\eqref{eq1_sumgrav}--\eqref{eq1gravop_sum} является недоопределенной, т.к. по заданной функции $\Delta g(x \lbcomma y \lbcomma 0)$ мы  пытаемся найти несколько неизвестных  функций  $\zeta_l=\zeta_l(x,y)$, что усиливает неединственность решения.  

%В случае задачи магнитометрии нижнее полупространство состоит из нескольких слоев постоянной вертикальной намагниченности со скачками намагниченности $\Delta J_l$. Поле от суперпозиции границ будет равным

Рассматривается трехмерная структурная обратная задача магнитометрии о нахождении поверхностей раздела сред на основе данных о магнитном поле, измеренном на некоторой площади земной поверхности, и скачкам векторов намагниченности. 

Предполагается, что нижнее полупространство состоит из нескольких слоев постоянной вертикальной намагниченности $J_l=J_{z,l}, l=1\lbcomma ... \lbcomma L)$ разделенных искомыми поверхностями $S_l$ где $L$ --- число границ раздела (рис.~\ref{fig7}). Магнитный эффект от такого полупространства равен сумме магнитных эффектов от всех поверхностей раздела.

\begin{figure}[h]
\center{\includegraphics[height=.5\textheight]{whitemagn.png}}
\caption{Модель многослойной среды в задаче магнитометрии}\label{fig7}
\end{figure}

Пусть поверхности раздела задаются уравнениями $z_l=z_l(x,y)$, скачки модулей векторов намагниченности  на них равны $\Delta J_l$, поверхности имеют горизонтальные асимптотические плоскости $z_l=H_l$, т.е. $\lim \limits_{| x  | + | y | \rightarrow \infty}| \zeta(x,y)-h | =0$. Поле от суперпозиции границ с точностью до постоянного слагаемого равно

\begin{equation}\label{eq3_summagn}
\begin{aligned}
B(z)\equiv \sum \limits_{l=1}^{L} \Delta J_l \int\limits_{-\infty}^\infty
\int\limits_{-\infty}^\infty \Bigg\{ \frac{\zeta_l(x,y)}{[{(x-x')^2+(y-y')^2+\zeta^2_l(x,y)}]^{3/2}} - \\
-\frac{h_l}{[{(x-x')^2+(y-y')^2+h^2_l}]^{3/2}} \Bigg\}dxdy = \Delta Z(x',y',0),
\end{aligned}
\end{equation}
где $\Delta Z(x,y,0)=\sum\limits^L_{l=0}\Delta Z_l$ --- суммарное аномальное магнитное поле, 
измеренное на земной поверхности.

%Функции $z_l=z_l(x,y)$ описывающие искомые поверхности раздела, удовлетворяют нелинейному двумерному интегральному уравнению первого рода~\eqref{eq1_sumgrav}. 

Уравнение~\eqref{eq3_summagn} является нелинейным двумерным интегральным уравненями первого рода относительно искомых функций $\zeta_l$. В операторном виде она запишется как

\begin{equation}\label{eq1magnop_sum}
B(\zeta_1,\zeta_2,...,\zeta_L) = \Delta Z(x',y',0).
\end{equation}

%\newpage
%\section{Традиционный алгоритм решения обратной задачи}
Традиционный алгоритм решения задачи заключается в использовании технологии разделения источников аномалий по глубине, разработанной П.~С. Мартышко и И.~Л. Пруткиным~\cite{mart_prut_2003}. Основная идея технологии заключается в аналитическом продолжении гравитационного поля вверх и вниз. Продолжение поля вверх на высоту $H$ осуществляется по формуле Пуассона, дающей решение задачи Дирихле для полупространства
\begin{equation} \nonumber
U(x',y',H) = \frac{1}{2\pi}\int\limits_{-\infty}^\infty \int\limits_{-\infty}^\infty \frac{H}{[{(x-x')^2+(y-y')^2+H^2}]^{3/2}}U(x,y,0) dx dx.
\end{equation}

Для уменьшения искажений, связанных с этой процедурой вследствие интегрирования по конечной области, из поля $U(x,y,0)$ предварительно вычитается функция, являющаяся решением плоской задачи Дирихле для уравнения Лапласа и принимающая на границе области те же значения, что и поле.

Чтобы ослабить влияние источников в слое между земной поверхностью $z=0$ и плоскостью $z=H$, пересчитанное вверх поле затем продолжается вниз на глубину $H$ по формуле 

\begin{equation} \nonumber
U(x',y',H) = \frac{1}{2\pi}\int\limits_{-\infty}^\infty \int\limits_{-\infty}^\infty \frac{2H}{[{(x-x')^2+(y-y')^2+4H^2}]^{3/2}}U(x,y,-H) dx dx.
\end{equation}

Данное выражение используется в качестве интегрального уравнения, в котором функция $U(x',y',H)$ известна, а искомым является функция $U(x,y,-H)$. Оператор уравнения является положительно определенным и самосопряженным, для решения используется схема М. М. Лаврентьева и итерационные методы решения СЛАУ~\cite{vasin_eremin}.

Проделав такую процедуру для двух значений $H_1$ и $H_2$, можно приближенно выделить гравитационный эффект от источников в горизонтальном слое между глубинами $H_1$ и $H_2$.

Таким образом, гравитационное или магнитное поле приближенно разделяется на компоненты, соответствующие отдельным границам, и задача сводится к решению нескольких задач, описанных в разделе 1.1.
